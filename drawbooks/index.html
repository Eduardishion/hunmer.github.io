<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<title>List of Drawing GuideBook</title>
	<link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/basictable.css" />
</head>
<style type="text/css">
    img {
    width: 100px;
    height: 100px;
    }
    span {
        display: block;
        text-align: center;
    }
</style>
<body>

        <div class="container">
            <span class="title">List of Drawing GuideBook(656)<br><span style="    font-size: 10px;">Tue, 28 Jul 2020 10:20:22 GMT</span></span>

    <table id="table-two-axis" class="two-axis">
            <thead>
              <tr>
                <th>Book</th>
                <th>ID</th>
                <th>Lang</th>
                <th>Size</th>
                <th>Action</th>
                <th>Backup</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td></td>
                <td>
                     <select id='lang_select'>
                        <option>ALL</option>
                        <option>CHINESE</option>
                        <option>ENGLISH</option>
                        <option>JAPANESE</option>
                    </select>
                </td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
          </tbody>
      </table>

        </div>
	<script src="js/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/drawbooks.js"></script>
    <script type="text/javascript" src="js/lazyload.min.js"></script>
    <script type="text/javascript" src="js/jquery.basictable.js"></script>

	<script>
           function getGETArray(){
        var a_result = [], a_exp;
        var a_params = window.location.search.slice(1).split('&');
        for(var k in a_params){
            a_exp = a_params[k].split('=');
            if(a_exp.length > 1){
                a_result[a_exp[0]] = a_exp[1];
            } 
        }
        return a_result;
    }
        var g_s_search = '';
        var g_search = [];
        var a_get = getGETArray();
        if(a_get['lang'] == undefined){
            a_get['lang'] = 'ALL';
        }
        $(function(){
            parseData();

            $(document).on('click', 'img', function(){
                var d = $(this).parent().parent().parent().find('a.read');
                if(d.length > 0) d[0].click();
            });
        })

        function openNew(url){
            if(window.newW != undefined) window.newW.close();
            window.newW = window.open(url, 'newwindow', 'height=1000, width=720, top=1000,left=100, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no,status=no');

        }

    function parseData(){
        $('tr:gt(1)').remove();

        var h = `<tr>
                <td></td>
                <td></td>
                <td>
                     <select id='lang_select'>
                        <option>ALL</option>
                        <option>CHINESE</option>
                        <option>ENGLISH</option>
                        <option>JAPANESE</option>
                    </select>
                </td>
                <td></td>
                <td></td>
                <td></td>
              </tr>`;
        var id = 0;
        for(var d of g_datas){
            if(a_get['lang'] != 'ALL' && d.lang != a_get['lang']) continue;
            id++;

             h = h +  `<tr>
             <td><span class='_id'>`+id+`</span><img data-src="`+d.img+`" class='lazyload'></td>
                <td><a target="_blank" href="https://www.google.com/search?q=`+d.title+`">`+d.title+`</a></td>
                
                <td>`+d.lang+`</td>`;

             if(d.online != undefined){
                h = h +  `<td>`+formatFileSize(d.online.size)+`</td>`;
                h = h +  `<td class='_action'><a class='read' href="javascript:openNew('https://neysummer2000-location.glitch.me/?id=`+d.online.id+`&title=`+ encodeURI(d.title)+`')">readOnline</a>&nbsp;&nbsp;&nbsp;<a target="_blank" href="http://pan-yz.chaoxing.com/download/downloadfile?fleid=`+d.online.id+`&puid=142588570">directDownload</a></td>`;
            }else{
                 h = h +  `<td></td><td></td>`;
            }

             h = h + '<td>';
            for(var i=0;i<d.link.length;i++){
                if(d.link[i].indexOf('提取码') === -1){
                 h = h + '<a target="_blank" href="'+d.link[i]+'">'+(i+1)+'.download</a>';
                }else{
                 h = h + d.link[i];
                }
                h = h + '     ';
            }
           
            h = h + '</td></tr>';
        }
        $('tbody').html(h);
        $('select').val(a_get['lang']);
        $(".lazyload").lazyload({effect: "fadeIn"});
        $('#table-two-axis').basictable();
    }

    function formatFileSize(fileSize) {
    if (fileSize < 1024) {
        return fileSize + 'B';
    } else if (fileSize < (1024*1024)) {
        var temp = fileSize / 1024;
        temp = temp.toFixed(2);
        return temp + 'KB';
    } else if (fileSize < (1024*1024*1024)) {
        var temp = fileSize / (1024*1024);
        temp = temp.toFixed(2);
        return temp + 'MB';
    } else {
        var temp = fileSize / (1024*1024*1024);
        temp = temp.toFixed(2);
        return temp + 'GB';
    }

 

}


    </script>
    <script type="text/javascript">

        $(function() {
            $(document).on('change', '#lang_select', function(){
                window.location.href = './index.html?lang='+$('#lang_select').val();
            })
        });

       /* function changeKeyword(){
            value = $('input').val().trim();
            g_s_search = value;
            g_search = [];
            g_i_search = 0;
            if(value !== ''){
                for(var i=0;i<g_datas.length;i++){
                    if(g_datas[i].title.toLocaleLowerCase().indexOf(value.toLocaleLowerCase()) !== -1){
                        g_search.push(i);
                    }
                }
                $('.result-container').html('<span>' + (g_search.length > 0 ? '1/' +g_search.length : 'Not Found!')+'</span>').show();
                if(g_search.length > 0){
                    toItem(g_search[0]);
                }
            }else{
                $('.result-container').html('<span>0</span>').show();
            }
        }

        // for(var i=0;i<g_search.length;i++){
        //     console.log(g_datas[g_search[i]].title);
        // }

        function searchToggle(obj, evt){
            value = $('input').val().trim();

            var container = $(obj).closest('.search-wrapper');

            if(!container.hasClass('active')){
                  container.addClass('active');
            }
            else if(container.hasClass('active') && $(obj).closest('.input-holder').length == 0){
                $('.search_active').removeClass('search_active');
                  container.removeClass('active');
                  // clear input
                  container.find('.search-input').val('');
                  // clear and hide result container when we press close
                  container.find('.result-container').fadeOut(100, function(){$(this).empty();});
            }
            if(value==''){
                evt.preventDefault();
            }

        }

        function submitFn(obj, evt){
            evt.preventDefault();
            if(g_search.length === 0){
               // $('.close').click();
                 return;
            }
            value = $(obj).find('.search-input').val().trim();
            if(value != g_s_search){
                changeKeyword();
                return;
            }
            g_i_search++;
            if(g_i_search > g_search.length - 1){
                g_i_search = 0;
            }
            $(obj).find('.result-container').html('<span>' + (g_i_search+1) + '/' +g_search.length +'</span>').show();

            $(obj).find('.result-container').fadeIn(100);
            toItem(g_search[g_i_search]);


        }

        function toItem(index){
            $('.search_active').removeClass('search_active');
            $(document).scrollTop($('#tabletolist1 ul:eq('+index+')').addClass('search_active').offset().top);
        }*/
    </script>
</body>
</html>